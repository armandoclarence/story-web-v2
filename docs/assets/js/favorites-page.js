var g=a=>{throw TypeError(a)};var v=(a,t,e)=>t.has(a)||g("Cannot "+e);var y=(a,t,e)=>(v(a,t,"read from private field"),e?e.call(a):t.get(a)),u=(a,t,e)=>t.has(a)?g("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(a):t.set(a,e),w=(a,t,e,s)=>(v(a,t,"write to private field"),s?s.call(a,e):t.set(a,e),e),L=(a,t,e)=>(v(a,t,"access private method"),e);import{s as M}from"./api-mapper.js";import{F as E,S as T,g as F}from"./index.js";import"./map.js";class I{constructor({view:t,model:e}){this.view=t,this.model=e}async loadFavorites(){try{const t=await E.getAllFavorites();console.log(t);const e=t.length>10;await this.view.showFavorites(t,e)}catch(t){throw console.error("Error loading favorites:",t),t}}}var m,c,f,b;class P{constructor(){u(this,f);u(this,m,10);u(this,c)}async render(){return`
      <section class="container">
        <h1 class="section-title">Cerita Favorit</h1>
        <div id="favorites-list" class="stories-list"></div>
        <div id="pagination-container"></div>
      </section>
    `}async afterRender(){w(this,c,new I({view:this,model:T})),await E.init(T),document.addEventListener("favorites-updated",async()=>{await y(this,c).loadFavorites()}),await y(this,c).loadFavorites()}async showFavorites(t,e){const s=document.getElementById("favorites-list"),o=document.getElementById("pagination-container");if(!t||t.length===0){s&&(s.innerHTML="<p>Belum ada cerita favorit.</p>"),o&&(o.innerHTML="");return}try{const i=t.slice(0,y(this,m)),d=await Promise.all(i.map(async l=>{console.log(l);const n=await M(l);return F({...n,isFavorited:l.isFavorite})}));s&&(s.innerHTML=d.join(""),setTimeout(()=>{s.querySelectorAll(".story-item").forEach((n,p)=>{n.style.opacity="0",n.style.transform="translateY(20px)",setTimeout(()=>{n.style.opacity="1",n.style.transform="translateY(0)"},p*100)})},50)),o&&(e?(o.innerHTML=`
            <div class="pagination">
              <button class="load-more-button">
                <span>Muat Lebih Banyak</span>
                <i class="fas fa-chevron-down"></i>
              </button>
            </div>
          `,L(this,f,b).call(this,t)):o.innerHTML="")}catch(i){console.error("Error showing favorites:",i),s&&(s.innerHTML="<p>Terjadi kesalahan saat memuat cerita favorit.</p>"),o&&(o.innerHTML="")}}}m=new WeakMap,c=new WeakMap,f=new WeakSet,b=function(t){const e=document.querySelector(".load-more-button");if(!e)return;let s=!1;e.addEventListener("click",async()=>{if(!s)try{s=!0,e.classList.add("loading"),e.disabled=!0;const o=e.querySelector("span");o.textContent="Memuat...";const i=document.querySelectorAll(".story-item").length,d=t.slice(i,i+y(this,m));if(d.length>0){await new Promise(r=>setTimeout(r,500));const l=await Promise.all(d.map(async r=>{const h=await M(r);return F({...h,isFavorited:!0})})),n=document.getElementById("favorites-list"),p=document.createElement("div");p.innerHTML=l.join(""),Array.from(p.children).forEach((r,h)=>{r.style.opacity="0",r.style.transform="translateY(20px)",n.appendChild(r),setTimeout(()=>{r.style.opacity="1",r.style.transform="translateY(0)"},h*100)}),i+d.length>=t.length&&(e.style.display="none")}}catch(o){console.error("Error loading more items:",o)}finally{s=!1,e.classList.remove("loading"),e.disabled=!1;const o=e.querySelector("span");o.textContent="Muat Lebih Banyak"}})};export{P as default};
