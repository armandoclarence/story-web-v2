var g=a=>{throw TypeError(a)};var v=(a,e,t)=>e.has(a)||g("Cannot "+t);var m=(a,e,t)=>(v(a,e,"read from private field"),t?t.call(a):e.get(a)),u=(a,e,t)=>e.has(a)?g("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(a):e.set(a,t),L=(a,e,t,s)=>(v(a,e,"write to private field"),s?s.call(a,t):e.set(a,t),t),M=(a,e,t)=>(v(a,e,"access private method"),t);import{s as T}from"./api-mapper.js";import{S as w,F as E,g as F}from"./index.js";import I from"./favorites-presenter.js";import"./map.js";var y,c,f,b;class P{constructor(){u(this,f);u(this,y,10);u(this,c)}async render(){return`
      <section class="container">
        <h1 class="section-title">Cerita Favorit</h1>
        <div id="favorites-list" class="stories-list"></div>
        <div id="pagination-container"></div>
      </section>
    `}async afterRender(){L(this,c,new I({view:this,model:w})),await E.init(w),document.addEventListener("favorites-updated",async()=>{await m(this,c).loadFavorites()}),await m(this,c).loadFavorites()}async showFavorites(e,t){const s=document.getElementById("favorites-list"),n=document.getElementById("pagination-container");if(!e||e.length===0){s&&(s.innerHTML="<p>Belum ada cerita favorit.</p>"),n&&(n.innerHTML="");return}try{const i=e.slice(0,m(this,y)),d=await Promise.all(i.map(async l=>{console.log(l);const o=await T(l);return F({...o,isFavorited:l.isFavorite})}));s&&(s.innerHTML=d.join(""),setTimeout(()=>{s.querySelectorAll(".story-item").forEach((o,p)=>{o.style.opacity="0",o.style.transform="translateY(20px)",setTimeout(()=>{o.style.opacity="1",o.style.transform="translateY(0)"},p*100)})},50)),n&&(t?(n.innerHTML=`
            <div class="pagination">
              <button class="load-more-button">
                <span>Muat Lebih Banyak</span>
                <i class="fas fa-chevron-down"></i>
              </button>
            </div>
          `,M(this,f,b).call(this,e)):n.innerHTML="")}catch(i){console.error("Error showing favorites:",i),s&&(s.innerHTML="<p>Terjadi kesalahan saat memuat cerita favorit.</p>"),n&&(n.innerHTML="")}}}y=new WeakMap,c=new WeakMap,f=new WeakSet,b=function(e){const t=document.querySelector(".load-more-button");if(!t)return;let s=!1;t.addEventListener("click",async()=>{if(!s)try{s=!0,t.classList.add("loading"),t.disabled=!0;const n=t.querySelector("span");n.textContent="Memuat...";const i=document.querySelectorAll(".story-item").length,d=e.slice(i,i+m(this,y));if(d.length>0){await new Promise(r=>setTimeout(r,500));const l=await Promise.all(d.map(async r=>{const h=await T(r);return F({...h,isFavorited:!0})})),o=document.getElementById("favorites-list"),p=document.createElement("div");p.innerHTML=l.join(""),Array.from(p.children).forEach((r,h)=>{r.style.opacity="0",r.style.transform="translateY(20px)",o.appendChild(r),setTimeout(()=>{r.style.opacity="1",r.style.transform="translateY(0)"},h*100)}),i+d.length>=e.length&&(t.style.display="none")}}catch(n){console.error("Error loading more items:",n)}finally{s=!1,t.classList.remove("loading"),t.disabled=!1;const n=t.querySelector("span");n.textContent="Muat Lebih Banyak"}})};export{P as default};
