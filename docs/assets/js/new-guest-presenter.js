var c=s=>{throw TypeError(s)};var u=(s,e,o)=>e.has(s)||c("Cannot "+o);var i=(s,e,o)=>(u(s,e,"read from private field"),o?o.call(s):e.get(s)),n=(s,e,o)=>e.has(s)?c("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,o),l=(s,e,o,h)=>(u(s,e,"write to private field"),h?h.call(s,o):e.set(s,o),o);import{q as p,I as a}from"./index.js";var r,t;class f{constructor({view:e,model:o}){n(this,r);n(this,t);l(this,r,e),l(this,t,o)}async showNewFormMap(){i(this,r).showMapLoading();try{await i(this,r).initialMap()}catch(e){console.error("showNewFormMap: error:",e)}finally{i(this,r).hideMapLoading()}}async postNewStoryGuest(e){if(i(this,r).showSubmitLoadingButton(),!navigator.onLine){try{await p(await a.init(),{type:"new-guest",description:e==null?void 0:e.description,photo:e==null?void 0:e.photo,lat:e==null?void 0:e.lat,lon:e==null?void 0:e.lon}),i(this,r).storeSuccessfully("Anda sedang offline. Cerita akan dikirim saat online kembali.",e)}catch(o){console.error("Failed to queue post offline:",o),i(this,r).storeFailed("Gagal menyimpan cerita secara offline.")}finally{i(this,r).hideSubmitLoadingButton()}return}try{const o=await i(this,t).storeNewStoryGuest(e);if(!o.ok){console.error("postNewStory: response:",o),i(this,r).storeFailed(o.message);return}i(this,r).storeSuccessfully(o.message,o.story)}catch(o){console.error("postNewStory: error:",o),i(this,r).storeFailed(o.message)}finally{i(this,r).hideSubmitLoadingButton()}}}r=new WeakMap,t=new WeakMap;export{f as default};
