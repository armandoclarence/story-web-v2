var m=a=>{throw TypeError(a)};var y=(a,t,e)=>t.has(a)||m("Cannot "+e);var o=(a,t,e)=>(y(a,t,"read from private field"),e?e.call(a):t.get(a)),s=(a,t,e)=>t.has(a)?m("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(a):t.set(a,e),l=(a,t,e,r)=>(y(a,t,"write to private field"),r?r.call(a,e):t.set(a,e),e);import{I as M,p as S,S as w,f as D,h as I,i as L,d as g}from"./index.js";import{s as b}from"./api-mapper.js";import{M as B}from"./map.js";var c,i,p;class E{constructor(t,{view:e,apiModel:r}){s(this,c);s(this,i);s(this,p);l(this,c,t),l(this,i,e),l(this,p,r)}async showStoryDetailMap(){o(this,i).showMapLoading();try{await o(this,i).initialMap()}catch(t){console.error("showStoryDetailMap: error:",t)}finally{o(this,i).hideMapLoading()}}async showStoryDetail(){o(this,i).showStoryDetailLoading();try{const t=await o(this,p).getStoryById(await M.init(),o(this,c));if(!t.ok){console.error("showStoryDetailAndMap: response:",t),o(this,i).populateStoryDetailError(t.message);return}console.log(t);const e=await b(t.story);console.log(e),o(this,i).populateStoryDetailAndInitialMap(t.message,e)}catch(t){console.error("showStoryDetailAndMap: error:",t),o(this,i).populateStoryDetailError(t.message)}finally{o(this,i).hideStoryDetailLoading()}}}c=new WeakMap,i=new WeakMap,p=new WeakMap;var d,n;class A{constructor(){s(this,d,null);s(this,n,null)}async render(){return`
      <section>
        <div class="story-detail__container">
          <div id="story-detail" class="story-detail"></div>
          <div id="story-detail-loading-container"></div>
        </div>
      </section>
    `}async afterRender(){l(this,d,new E(S().id,{view:this,apiModel:w})),o(this,d).showStoryDetail()}async populateStoryDetailAndInitialMap(t,e){if(console.log(e),document.getElementById("story-detail")&&(document.getElementById("story-detail").innerHTML=D({...e})),I(document.getElementById("images")),await o(this,d).showStoryDetailMap(),console.log(o(this,n)),o(this,n)&&e.lat&&e.lon){const r=[e.lat,e.lon],h={alt:e.description},u={content:e.description};o(this,n).changeCamera(r),o(this,n).addMarker(r,h,u)}}populateStoryDetailError(t){document.getElementById("story-detail").innerHTML=L(t)}async initialMap(){document.getElementById("map")&&l(this,n,await B.build("#map",{zoom:15},!0))}showStoryDetailLoading(){document.getElementById("story-detail-loading-container").innerHTML=g()}hideStoryDetailLoading(){document.getElementById("story-detail-loading-container").innerHTML=""}showMapLoading(){document.getElementById("map-loading-container")&&(document.getElementById("map-loading-container").innerHTML=g())}hideMapLoading(){document.getElementById("map-loading-container")&&(document.getElementById("map-loading-container").innerHTML="")}showSubmitLoadingButton(){document.getElementById("submit-button-container").innerHTML=`
      <button class="btn" type="submit" disabled>
        <i class="fas fa-spinner loader-button"></i> Tanggapi
      </button>
    `}hideSubmitLoadingButton(){document.getElementById("submit-button-container").innerHTML=`
      <button class="btn" type="submit">Tanggapi</button>
    `}}d=new WeakMap,n=new WeakMap;export{A as default};
