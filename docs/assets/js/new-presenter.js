var c=i=>{throw TypeError(i)};var a=(i,e,o)=>e.has(i)||c("Cannot "+o);var s=(i,e,o)=>(a(i,e,"read from private field"),o?o.call(i):e.get(i)),n=(i,e,o)=>e.has(i)?c("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,o),l=(i,e,o,h)=>(a(i,e,"write to private field"),h?h.call(i,o):e.set(i,o),o);import{q as p,I as u}from"./index.js";var r,t;class f{constructor({view:e,model:o}){n(this,r);n(this,t);l(this,r,e),l(this,t,o)}async showNewFormMap(){s(this,r).showMapLoading();try{await s(this,r).initialMap()}catch(e){console.error("showNewFormMap: error:",e)}finally{s(this,r).hideMapLoading()}}async postNewStory(e){if(s(this,r).showSubmitLoadingButton(),!navigator.onLine){try{await p(await u.init(),{type:"new",description:e==null?void 0:e.description,photo:e==null?void 0:e.photo,lat:e==null?void 0:e.lat,lon:e==null?void 0:e.lon}),s(this,r).storeSuccessfully("Anda sedang offline. Cerita akan dikirim saat online dan login kembali.",e)}catch(o){console.error("Failed to queue post offline:",o),s(this,r).storeFailed("Gagal menyimpan cerita secara offline.")}finally{s(this,r).hideSubmitLoadingButton()}return}try{const o=await s(this,t).storeNewStory(e);if(!o.ok){console.error("postNewStory: response:",o),s(this,r).storeFailed(o.message);return}s(this,r).storeSuccessfully(o.message,o.data)}catch(o){console.error("postNewStory: error:",o),s(this,r).storeFailed(o.message)}finally{s(this,r).hideSubmitLoadingButton()}}}r=new WeakMap,t=new WeakMap;export{f as default};
